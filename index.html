<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">


    <style>
        * {
            margin: 0;
            padding: 0;
        }

        html {
            font-size: 240px;
        }

        #main {
            position: relative;
        }

        #sound {
            position: relative;
            width: 0.3rem;
            height: 0.3rem;
            border-radius: 50%;
            background: url("images/smallBell.jpg") no-repeat;
            background-size: 100% 100%;

        }

        .music {

            position: absolute;
            right: 0.05rem;
            top: 0.05rem;
            width: 0.3rem;
            height: 0.3rem;;
        }

        #music div {
            position: absolute;
            top: 50%;
            left: 50%;
            margin: -0.052rem 0 0 -0.041rem;
            width: 0.083rem;
            height: 0.104rem;
            /*background: blue;*/
            background-image: url("images/start.png");

        }

        #music #start {
            position: absolute;
            background-position-y: 0;
        }

        #music {
            position: absolute;
            top: 50%;
            left: 50%;
            margin: -0.052rem 0 0 -0.041rem;
            width: 0.083rem;
            height: 0.104rem;
        }

        #music #end {
            position: absolute;
            display: none;
            background-position-y: 25px;
        }

        @-webkit-keyframes circle {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        .music #musicList {
            display: none;
            position: absolute;
            top: -0.02rem;
            right: 0;
            list-style: none;
            width: 1.0rem;
            padding: 0.02rem 0 0.02rem 0
        }

        .music #musicList li {
            width: 100%;
            height: 0.125rem;
            line-height: 0.125rem;
            background: #ccc;
            font-size: 0.07rem;
            opacity: 0.7;
            text-align: center;
        }

        #controlMusicUl {
            position: absolute;
            top: -0.045rem;
            right: -0.045rem;
            width: 0.1rem;
            height: 0.1rem;
            background: url("images/more.png") no-repeat;
            border-radius: 50%;
            background-position-x: -0.0375rem;
            background-position-y: -0.0375rem;
        }
    </style>
</head>
<body>
<div id="main">
    <div class="music">
        <div id="sound">
            <audio id="bell" src="music/杜雯媞、王艺翔%20-%20雪.mp3" preload="metadata" loop></audio>
        </div>
        <div id="music">
            <div id="start"></div>
            <div id="end"></div>
        </div>
        <div id="controlMusicUl"></div>
        <ul id="musicList"></ul>
    </div>
</div>
<script src=""></script>
<script src="Json.js"></script>
<script>
    function getEle(ele) {
        return document.querySelector(ele)
    }
    function getEleAll(ele) {
        return document.querySelectorAll(ele)
    }
    var sound = getEle("#sound");
    var bell = getEle("#bell");
    var musicUl = getEle("#musicList");


    var controlMusicUl = getEle("#controlMusicUl");

    //    获取json对象的长度
    function getJsonLength(jsonData) {
        var jsonLength = 0;
        for (var item in jsonData) {
            jsonLength++;
        }
        return jsonLength;
    }
    //绑定音乐列表
    var ary = [];
    function bindMusicList() {
        var musicLists = getJsonLength(Json.music);
        var str = "";

        for (var key in Json.music) {
            str += "<li>" + key + "</li>";

            ary.push(Json.music[key]);

        }
        
        musicUl.innerHTML = str;

    }


    //    控制音乐
    getEle(".music").onclick = function (e) {
        var start = getEle("#start");
        var end = getEle("#end");
        var controlMusicUl = getEle("#controlMusicUl");

        if (e.target == start) {
            start.style.display = "none";
            end.style.display = "block";
            bell.play();
            sound.style.webkitAnimation = "circle 1.5s infinite linear";
        }
        if (e.target == end) {
            bell.pause();
            sound.style.webkitAnimation = "none";
            end.style.display = "none";
            start.style.display = "block";
        }
        if (e.target == controlMusicUl) {
            console.log(controlMusicUl);

            bindMusicList();
            controlMusicUl.style.display = "none";
            musicUl.style.display = "block";
            var musicList = getEleAll("#musicList>li");
            console.log(musicList);
            for (var i = 0; i < musicList.length; i++) {

                    ~function (i) {
                        musicList[i].onclick = function () {
                           bell.pause();
                            bell.src = ary[i];
                            musicUl.style.display = "none";
                            controlMusicUl.style.display = "block";
                            bell.play();
                            sound.style.webkitAnimation = "circle 1.5s infinite linear";
                            start.style.display = "none";
                            end.style.display = "block";
                        }

                    }(i);


            }
        }


    }
</script>
</body>
</html>
